<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a posterior log-pdf function for monte carlo sampling the model parameters. — mc.setup • ambrosia</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a posterior log-pdf function for monte carlo sampling the model parameters. — mc.setup" />
<meta property="og:description" content="The function returned takes a vector of parameter values as an argument and
returns a the log of the posterior pdf calculated by comparing this data to
the supplied observed data.  There is an optional second argument that is
described further below.  The log-post function should be usable in any MC
sampler.  It will also work in an optimizer, provided you configure it to
look for a maximum rather than a minimum." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ambrosia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/ambrosia_vignette.html">`ambrosia`: User Tutorial</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a posterior log-pdf function for monte carlo sampling the model parameters.</h1>
    
    <div class="hidden name"><code>mc.setup.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function returned takes a vector of parameter values as an argument and
returns a the log of the posterior pdf calculated by comparing this data to
the supplied observed data.  There is an optional second argument that is
described further below.  The log-post function should be usable in any MC
sampler.  It will also work in an optimizer, provided you configure it to
look for a maximum rather than a minimum.</p>
    </div>

    <pre class="usage"><span class='fu'>mc.setup</span><span class='op'>(</span>
  <span class='va'>obsdata_filename</span>,
  logprior <span class='op'>=</span> <span class='cn'>NULL</span>,
  logfile <span class='op'>=</span> <span class='cn'>NULL</span>,
  chunksize <span class='op'>=</span> <span class='fl'>10</span>,
  trace_param <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obsdata_filename</th>
      <td><p>File name for the oberved data.</p></td>
    </tr>
    <tr>
      <th>logprior</th>
      <td><p>Optional function that takes a parameter vector and returns a
log prior probability density.  It need not (and should not) support the
log-posterior function's optional argument described in the details section.</p></td>
    </tr>
    <tr>
      <th>logfile</th>
      <td><p>Optional file name for logging.</p></td>
    </tr>
    <tr>
      <th>chunksize</th>
      <td><p>See details for description of chunking and why it is
needed.</p></td>
    </tr>
    <tr>
      <th>trace_param</th>
      <td><p>Set this to TRUE to generate the data file (.dat file) during the statistical fitting procedure.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A function that computes the log-posterior probability density for an
input vector of parameters.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The observed data should have the following columns: Ps, Pn, Y, Qs, Qn,
sigQs, sigQn.  There is a special provision to process the dataset produced
for GCAM</p>
<p>The demand system employs a nonlinear equation solver, which is used to
solve for the budget fractions that appear in the demand equations.  Although
structured as a system of equations, each time is actually independent of all
the others, but the solver has no way of knowing this.  Because the
complexity of the solver scales nonlinearly with the number of equations, we
break the times in the dataset up into chunks of modest size.</p>
<p>The optional second argument to the log-posterior function produced by this
function gives the number of parameter sets that are concatenated into a
single vector.  This capability is supplied to make life easier back when we
were calling these functions from a C code that used SSE/AVX instructions to
vectorize the sampler.  Samplers written in R can and should pretend that
this argument doesn't exist.</p>
    <h2 class="hasAnchor" id="todo"><a class="anchor" href="#todo"></a>TODO</h2>

    


<ul>
<li><p>Provide an example dataset for the observed data.</p></li>
<li><p>Dispense with this chunk business and just run a 1-d solver in a loop.
What was I thinking?</p></li>
</ul>


  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kanishka Narayan, Chris Vernon, Stephanie Waldhoff, James Edmonds, Ryna Cui.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


